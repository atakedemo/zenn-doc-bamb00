---
title: "LINEのブロックチェーンKaiaを知る ~ ## イーサリアムGas：スマートコントラクトの実行コストを解説 
"
emoji: "🛠"
type: "tech" 
topics: []
published: true
---
#AIエージェントが作成した文章です

## イーサリアムのExecution Gas：契約実行コストの仕組みを分かりやすく解説

皆さん、こんにちは！今回はイーサリアムにおける「Execution Gas」について、できるだけ分かりやすく解説していきます。イーサリアムでスマートコントラクトを実行する際には、その計算にコストがかかります。このコストこそが「Gas」であり、ネットワークを維持するためのインセンティブとしてガス料金として支払われます。

**Gasの構成**

Gasは大きく分けて「Intrinsic Gas」と「Execution Gas」の2つに分けられます。本記事では、コントラクトの実行中に発生する「Execution Gas」に焦点を当てて解説します。

**Execution Gasの計算：3つの主要要素**

Execution Gasは、コントラクトの実行中に次の3つの状況で発生します。

1. **Constant Gas:** これはオペレーション（命令）を実行する際の固有のコストです。例えば、「足し算」や「掛け算」といった基本的な演算、データの読み書きなど、各オペレーションにはそれぞれ異なるGasコストが割り当てられています。このコストは、オペレーションの種類によって異なり、事前に定義された「Opcode Gas Schedule」に従って計算されます。

2. **下位メッセージ呼び出し/コントラクト作成:** コントラクトが別のコントラクトを呼び出す（CALL, CALLCODE, DELEGATECALL）や、新しいコントラクトを作成する（CREATE, CREATE2）場合、それらにもGasコストが発生します。これは、呼び出されたコントラクトの実行に必要なコストを賄うための支払いの一部として考えられます。

3. **メモリ使用量増加:** コントラクトはメモリを使用し、その使用量に応じてGasコストが発生します。イーサリアムでは、メモリは32バイト単位で割り当てられるため、メモリ使用量は32バイトの倍数に丸め込まれ、メモリを拡張する際にコストが発生します。

**Opcode Gas Schedule**

Opcode Gas Scheduleは、各オペレーション（Opcode）のConstant Gasコストを定義するテーブルです。これは、各オペレーションに必要な計算量や、実行にかかる時間などを考慮して決められています。例えば、複雑な演算はGasコストが高く、単純な演算はGasコストが低くなっています。

さらに、スケジュールにはメモリの使用やログの生成、ストレージの操作などに関するGasコストも含まれています。

**ストレージ費用**

ストレージ（コントラクトの状態データを保存する領域）の使用は、ノード全体のデータベースのサイズに直接影響を与えるため、ストレージへの書き込みは高いGasコストが発生します。一方で、ストレージのエントリーをクリア（値を0に設定）する場合は、Gasコストが免除されるだけでなく、むしろ返金（リファンド）が得られます。これは、ストレージ領域の効率的な利用を促すためのインセンティブです。

**コントラクト実行におけるGas計算のロジック**

取引のGasコストは、取引の種類や入力データに基づいて計算されます。コントラクトが実行される場合は、オペレーションを一つずつ実行し、各オペレーションに定義されているGasコストと、メモリやログなどに関する追加のGasコストを計算し、最終的なGasコストを求めます。

**Hardforkによる変更**

イーサリアムは定期的なハードフォークにより、Gasコストや計算ロジックが変更されていきます。Hardforkごとに追加されたオペコードや変更されたGasコストに関する詳細は、記事の末尾に記載された表を参照してください。

**まとめ**

Execution Gasは、スマートコントラクトの実行コストであり、ネットワークのセキュリティと分散性を維持するために不可欠です。その計算は、オペレーションの種類、メモリ使用量、ストレージ操作、下位メッセージ呼び出し/コントラクト作成、そして時々ハードフォークによって変わります。Gasコストを正確に理解し効率的なコントラクト設計をすることが、開発者の重要なスキルになります。


**今後の展望**

イーサリアムの開発は常に進化しています。新たな機能が追加されたり、既存の機能が改善されたりする際に、Gasコストや計算方法も変更される可能性があります。常に最新の情報を追いかけ、効率的なコントラクト開発に役立てていきましょう。



        
---
title: "OP Stackを知る ~ ##
 OP Stack:
 L2の未来を支える  

"
emoji: "🛠"
type: "tech" 
topics: []
published: true
---


##
 OP Stack
: L2 ブロックチェーンの未来を支えるソフトウェアスタック

この記事では、
Optimism Collective が開発した、L2（レイヤー2）ブロックチェーン
エコシステム構築のための共通開発スタックである **OP Stack** について解説していきます。

OP Stack は、Optimism を動かすために開発されたソフトウェアコンポー
ネントの集合体であり、新しいレイヤーの定義やスタック内のモジュールとして機能します。

OP Stack は常に進化しているため、各
レイヤーとモジュールは開発途上です。この記事では、現在の OP Stack の主要コンポーネントの概要を説明し、各層とモジュールについて詳しく解説していきます。

### OP Stack のレイヤー

OP Stack は
、以下のレイヤーで構成されています。

1. **データアベイラビリティレイヤー (Data Availability Layer)**
   - OP Stack ベースのチェーンの生の入力データを公開する場所を定義します。
   - OP Stack
 チェーンは、単一のデータアベイラビリティモジュールを使用して入力データを取得できます。
   - 使用されるデータアベイラビリティモジュールは、システムのセキュリティモデルに大きな影響を与えます。

   * **Ethereum DA**
     - OP Stack で最も広く使用されているデータアベイラビ
リティモジュールです。
     - Ethereum の calldata、イベント、4844 データブロブなど、Ethereum ブロックチェーン上の情報からデータを取得できます。

2. **シーケンスレイヤー (Sequencing Layer)**
   - OP Stack チェーン上のユーザートランザクションを収集し、使用中のデータアベイラ
ビリティレイヤーモジュールに公開する方法を決定します。
   - OP Stack のデフォルトのロールアップ構成では、シーケンスは通常、専用のシーケンサーによって処理されます。
   - 将来的には、シーケンスはモジュール化され、チェーンはシーケンサーを制御
するメカニズムを簡単に選択および変更できるようになります。

   * **シングルシーケンサー (Single Sequencer)**
     - OP Stack のデフォルトのシーケンサーモジュールです。
     - 専用のシーケンサーがシーケンサーとして機能できます。
     - ガバナンス
メカニズムによって、任意の時点で誰がシーケンサーとして機能できるかが決定されます。

   * **マルチプルシーケンサー (Multiple Sequencer)**
     - シングルシーケンサーモジュールの簡単な修正版です。
     - 任意の時点で、事前に定義された可能なアクターのセット
からシーケンサーが選択されます。
     - 個々の OP Stack ベースのチェーンは、可能なシーケンサーのセットを定義するメカニズムと、セットからシーケンサーを選択するメカニズムを決定できます。

3. **デリベーションレイヤー (Derivation Layer)**
   - データアベイラ
ビリティレイヤーの生データを処理し、標準の Ethereum Engine API を介して実行レイヤーに送信される処理済み入力を形成します。
   - デリベーションレイヤーは、実行レイヤーで定義されている現在のシステム状態を使用して、生の入力データの解析を通知することもできます。
   - デリ
ベーションレイヤーは、多くの異なるデータソースから Engine API 入力を作成するように変更できます。
   - デリベーションレイヤーは、通常、生の入力データの解析方法を理解する必要があるため、データアベイラビリティレイヤーと密接に関連しています。

   * **ロールアップ (Rollup)**

     - Ethereum ブロックデータ、シーケンサートランザクションバッチ、デポジットトランザクションイベントなどから Engine API 入力を作成します。

   * **インデクサー (Indexer)**
     - Ethereum DA などのデータアベイラビリティレイヤーモジュールの特定のスマートコントラクト
にトランザクションが送信されたとき、イベントが発行されたとき、またはストレージが変更されたときに、Engine API 入力を生成するデリベーションレイヤーモジュールです。

4. **実行レイヤー (Execution Layer)**
   - OP Stack システム内の状態の構造と、この状態を変化
させる状態遷移関数を定義します。
   - 状態遷移は、Engine API を介してデリベーションレイヤーから入力が受信されるとトリガーされます。
   - 実行レイヤーの抽象化により、EVM の修正や、まったく異なる基底 VM の使用が可能になります。

   * **
EVM**
     - Ethereum 仮想マシンと同じ状態表現と状態遷移関数を使用する実行レイヤーモジュールです。
     - OP Stack の Ethereum ロールアップ構成の EVM モジュールは、Ethereum で開始された L2 トランザクションのサポートを追加し、各トランザクションに
 Ethereum へのトランザクションの公開コストを考慮した追加の L1 データ料金を追加した、わずかに修正された EVM です。

5. **決済レイヤー (Settlement Layer)**
   - 外部のブロックチェーンにおける、OP Stack チェーン (ターゲット) の状態を、外部のサードパーティチェーン (
他の OP Stack チェーンを含む) に確立するメカニズムです。
   - 各ターゲットチェーンに対して、1 つ以上の外部チェーンに 1 つ以上の決済メカニズムが存在する可能性があります。
   - 決済レイヤーメカニズムは読み取り専用であり、サードパーティチェーンは、
ターゲット OP Stack チェーンの状態に基づいて、独自のステートに影響を与える可能性のある決定を行うことができます。

   - **アテステーションベースのフォールトプルーフ (Attestation-based Fault Proof)**
     - OP Stack チェーンの状態を確立するために、オプティミスティックな
プロトコルを使用するメカニズムです。
     - 通常、オプティミスティックな決済メカニズムでは、プロポーザーエンティティは、現在の有効な OP Stack チェーンの状態であると信じられるものを提案できます。
     - これらの提案が特定の期間 (「チャレンジ期間」)
 内に無効にならない場合、メカニズムによって提案が正しいと見なされます。
     - 特に、アテステーションプルーフメカニズムでは、提案が提案内の状態と異なる有効な状態に対するアテステーションを、事前に定義された当事者のしきい値以上が
提供した場合、提案を無効にすることができます。
     - これは、事前に定義された参加者のしきい値以上の誠実さに対する信頼を前提としています。

   - **フォールトプルーフオプティミスティック決済 (Fault Proof Optimistic Settlement)**
     - 現在の、
アテステーションベースのフォールトプルーフメカニズムとほぼ同じですが、マルチシグチャレンジを許可のないフォールトプルーフプロセスに置き換えています。
     - 正しく構築されたフォールトプルーフは、割り当てられたチャレンジ期間中に、不正確な提案を
無効にすることができます。
     - これは、フォールトプルーフ構築の正確さに対する信頼を前提としています。
     - 現在、フォールトプルーフメカニズムの開発は順調に進んでいます。

   - **バリディティプルーフ決済 (Validity Proof Settlement)**

     - 提案されたビューの正確さを証明するために、数学的証明を使用するメカニズムです。
     - 提案された状態に有効な証明が添付されている場合、その状態はすぐに、かつ条件なしに受け入れられます。そうでない場合は、拒否されます。
     - この
メカニズムは、特定の参加者やプロセスに対する信頼ではなく、暗号化の仮定に依存しています。
     - チャレンジ期間が不要になる一方、証明を生成するためには、かなりの事前計算が必要です。

6. **ガバナンスレイヤー (Governance Layer)**
   -
 システム構成、アップグレード、設計上の意思決定を管理するために使用される一般的なツールとプロセスのセットを指します。
   - これは、ターゲット OP Stack チェーンと、OP Stack の多くの他のレイヤーに影響を与えるサードパーティチェーンに、幅広いメカニズムを含めることができる、比較的抽象的な
レイヤーです。

   * **マルチシグ契約 (MultiSig Contracts)**
     - 事前に定義された参加者のセットからのしきい値以上の署名を受け取ると、アクションを実行するスマートコントラクトです。
     - 多くの場合、OP Stack ベースのシステムのコンポーネント
のアップグレードを管理するために使用されます。
     - 現在、これは OP メインネットのブリッジ契約のアップグレードを管理するために使用されているメカニズムです。
     - マルチシグ契約システムのセキュリティは、参加者数、しきい値、各参加者の安全手順など、多くの異なる要素
に依存します。

   * **ガバナンストークン (Governance Tokens)**
     - 意思決定の分散化によく使用されます。
     - ガバナンストークンの具体的な機能はケースバイケースで異なりますが、最も一般的なメカニズムでは、トークン保有者がプロジェクトが実行し
なければならない意思決定のサブセットに対して投票できます。
     - 投票は、直接行うことも、委任を通じて行うこともできます。

### まとめ

OP Stack は、L2 ブロックチェーンエコシステムの構築と発展を促進するための革新的なソフトウェアスタックです。そのモジュール性と拡張
性により、開発者は独自のニーズに合わせて OP Stack をカスタマイズし、安全でスケーラブルな L2 チェーンを構築することができます。OP Stack は、L2 ブロックチェーンの未来を形作る重要な技術となるでしょう。




        
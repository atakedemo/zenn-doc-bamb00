##
 異なるブロックチェーン間の相互運用性におけるセキュリティ上の考慮事項

この記事では、異なる
ブロックチェーン間の相互運用性におけるセキュリティ上の課題と、その解決策について
解説します。特に、**「開始メッセージ」**と**「実行メッセージ」**の関係に着目し、それぞれのセキュリティレベルとトレードオフについて詳しく説明します。


### 問題：開始メッセージと実行メッセージの同期

ブロックチェーン間の相互運用性を実現するためには、あるブロックチェーン上の**開始メッセージ**に基づ
いて、別のブロックチェーン上で**実行メッセージ**を実行する必要があります。しかし、開始メッセージが本当に存在するのか、それが正しい情報なのかを保証することが課題となります。

**例:**

あるブロックチェーンA上のブロックBに、
別のブロックチェーンCのトランザクション実行に必要な情報（開始メッセージ）が含まれているとします。ブロックチェーンCのシーケンサーはこの情報に基づいてトランザクションを実行しようとします。

しかし、以下のいずれかの理由により、開始メッセージ
が最終的にブロックチェーンAに書き込まれなかった場合、実行メッセージは不正な情報に基づいて実行されてしまいます。

1. **二重送信（Equivalence）:**シーケンサーが、ゴシッププロトコルで送信したブロックと、L1（Ethereumメインネット）に書き込まれた
ブロックの内容が異なる場合。
2. **誤った情報:**シーケンサーが、開始メッセージを含むブロックチェーンAのノードから誤った情報を取得した場合。

### 解決策：開始メッセージのセキュリティレベル

開始メッセージのセキュリティレベルによって、実行メッセージの安全性が大きく左右されます。

1
. **不安全な開始メッセージ:** 
    - 最も低いセキュリティレベル
    - 開始メッセージがゴシッププロトコルで受け取られた時点で、実行メッセージを実行することを許容
    - 遅延が最小ですが、二重送信のリスクが高い
    - 開始メッセージがL1に書き込ま
れなかった場合、実行メッセージを含むブロックは**「デポジット専用ブロック」**として扱われます。
    - デポジット専用ブロックは、新しいトランザクションを受け付けず、L1の情報を反映しません。

2. **安全な開始メッセージ:**
    - 開始メッセージを含むブロックが
L1に書き込まれ、そのブロックと依存するすべてのブロックがL1に書き込まれたことを確認してから、実行メッセージを実行
    - 安全性が高まりますが、遅延が発生します
    - L1の再編成による影響を受けなくなりますが、メッセージ送信に時間がかかります。

3. **
最終確定された開始メッセージ:**
    - 開始メッセージを含むブロックがL1で最終確定された（再編成不可能な状態）ことを確認してから、実行メッセージを実行
    - 最も高いセキュリティレベル
    - メッセージ送信に最も時間がかかりますが、二重送信や再編成のリスクを完全に排除
できます。

### セキュリティレベルと遅延のトレードオフ

上記のように、セキュリティレベルと遅延の間にはトレードオフが存在します。

- **低いセキュリティレベル:** 遅延が小さく、スループットが高いですが、二重送信や誤った情報のリスクが高まります。
- **高いセキュリティレベル
:** 遅延が大きく、スループットが低くなりますが、二重送信や誤った情報のリスクを低減できます。

### 具体的な例：OP Stack

OP Stack（OptimismやBaseなどのOptimistic Rollupチェーン）では、開始メッセージが安全になるまで、約2.5分
かかる場合があり、その間に実行メッセージは実行されません。これは、OP StackがL1のセキュリティを確保するためには、ある程度の遅延が必要であることを意味します。

### まとめ

異なるブロックチェーン間の相互運用性を実現するには、開始メッセージのセキュリティを確保することが重要です。上記の説明は、
その問題と解決策の概要を示したものであり、詳細についてはOP Stackのドキュメントや関連資料を参照してください。


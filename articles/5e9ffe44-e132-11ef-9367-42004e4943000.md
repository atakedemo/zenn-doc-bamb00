##
  L2 間の相互運用性におけるセキュリティ対策：安全なメッセージング
の仕組み

この記事では、L2（レイヤー2）ブロックチェーン間の相互運用性
におけるセキュリティ対策について解説します。特に、**メッセージングの安全性**に焦点を当て、その仕組みとトレードオフについて詳しく説明します。


### 相互運用性の脆弱性：なぜ安全なメッセージングが必要なのか？

L2 ブロックチェーン間の相互運用性は、ブロックチェーンエコシステムの拡大
に欠かせない要素です。しかし、相互運用性の実現には、いくつかのセキュリティ上の課題が存在します。その中でも特に重要なのが、**メッセージングの安全性**です。

**相互運用性の脆弱性は、以下の2つの
ケースで発生します。**

* **二重送信 (Equivocation)**：シーケンサー（ブロック生成者）が、ゴシッププロトコルを通して公開したブロックと、最終的にL1（レイヤー1）に書き込まれる
ブロックが異なる場合。この場合、ゴシッププロトコル上のブロックにはメッセージが含まれているにもかかわらず、L1 に書き込まれたブロックにはそのメッセージが存在しないという状況が発生します。
* **誤った情報**: シーケンサーが、メッセージのソースとなるブロックチェーンから誤った情報を取得した場合
。

**これらの問題を防ぐため、L2 間の相互運用性では、安全なメッセージングが不可欠になります。**

### 安全なメッセージング：Latency vs. Security のトレードオフ

安全なメッセージングには、**Latency (待ち時間)**と**Security (安全性)**の間の
トレードオフが存在します。

**Latency を最小限に抑える場合、シーケンサーは、ゴシッププロトコルを通して公開されたブロックをすぐに受け入れることができます。** しかし、この場合、ソースとなるシーケンサーが誤った情報を送信する可能性があり、セキュリティリスクが高まります。

**
一方、セキュリティを高めるためには、ソースとなるブロックが L1 に書き込まれるまで待つ必要があります。** この場合、メッセージングの Latency は長くなりますが、ソースとなるブロックが実際に存在し、正しい情報であることを確認できます。

### 安全なメッセージングの仕組み: 3 つのレベル

L2
 間の相互運用性では、Latency と Security のバランスを考慮し、3 つのレベルの安全性を持つメッセージングが提供されます。

1. **Unsafe Initiating Messages (不安定な初期メッセージ)**:
    * Latency は最小限ですが、セキュリティリスクが高い。
    * ソースとなるブロックが
 L1 に書き込まれる前にメッセージを受け入れる。
    * ソースとなるブロックが L1 に書き込まれた後、そのブロックと先行するすべてのブロックが L1 に書き込まれるまで、メッセージは "unsafe" とみなされます。
    * **リスク:** ソースとなるブロックが L1 に書き
込まれる際に、メッセージが削除されている場合、そのメッセージに依存するブロックは "deposit-only" ブロックとして扱われ、処理されなくなります。

2. **Safe Initiating Messages (安全な初期メッセージ)**:
    * Latency はやや高くなりますが、安全性は向上します。
    *
 ソースとなるブロックが L1 に書き込まれ、そのブロックと先行するすべてのブロックが L1 に書き込まれていることを確認してから、メッセージを受け入れる。
    * **リスク:** L1 でリオーガナイゼーション (再編成) が発生した場合のみ、状態の再計算が必要となります。


3. **Finalized Initiating Messages (最終確定された初期メッセージ)**:
    * Latency は最も高くなりますが、セキュリティは最高レベルです。
    * ソースとなるブロックが L1 で最終確定されるまで、メッセージを受け入れません。
    * **リスク:** リオーガナイゼ
ーションの発生は無視できます。

### まとめ

L2 間の相互運用性における安全なメッセージングは、Latency と Security のバランスを考慮して設計されています。各レベルの安全性は、異なる Latency と Security のトレードオフを提供します。開発者は、それぞれのユースケースに最適なレベル
を選択することが重要です。

この技術は、相互運用性を安全に実現するための重要な要素であり、ブロックチェーンエコシステムの進化を促進する役割を担っています。


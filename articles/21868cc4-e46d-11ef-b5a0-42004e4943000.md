---
title: "OP Stackを知る ~ ## オプティミズムスマートコントラクト：本番環境への道筋 
"
emoji: "🛠"
type: "tech" 
topics: []
published: true
---
はじめましてbamb00です！

## オプティミズムスマートコントラクトの概要：本番環境への展開に向けて

皆さん、こんにちは！今回は、オプティミズム（Optimism）のスマートコントラクトについて、その機能と、本番環境での展開に向けた考察を交えて解説していきます。

**スマートコントラクトとは？**

スマートコントラクトとは、ブロックチェーン上に配置された自己実行可能なコードです。一度配置されると、予期せぬ操作や変更なく、コードで記述された条件が満たされた場合に自動的に実行されます。オプティミズムは、イーサリアムのレイヤー2ソリューションであり、スマートコントラクトを使用して、イーサリアムメインネットよりも高速で低コストなトランザクション処理を実現しています。

**オプティミズムのレイヤー1コントラクト**

レイヤー1コントラクトは、イーサリアム上に展開されています。主な機能は、ドメイン間のメッセージ送受信の仲介とレイヤー2の有効なステートルートの維持です。

オプティミズムでは、コントラクトのリリースは厳格に管理されており、バージョン管理（`op-contract/vX.Y.Z`）、リリースノートの公開、セキュリティ監査など、本番環境での展開に耐えうる品質とセキュリティが確保されています。`op-contracts/v1.6.0` や `op-contracts/v1.5.0` などのリリースでは、セキュリティ脆弱性の修正や、Guardian（監視者）役割の再割り当て、セキュリティ向上のための機能追加がなされています。これは、オプティミズムが安全性と分散化に重点を置いていることを示しています。

具体的なコントラクトには、`AddressManager`、`SuperchainConfig`、`L1CrossDomainMessenger`、`L1ERC721Bridge`、`L1StandardBridge`、`OptimismPortal`、`ProtocolVersions`、`SystemConfig`などが含まれます。これらのコントラクトは、L1とL2間のメッセージ送受信、トークンブリッジ、ネットワークの設定管理など、様々な重要な機能を担っています。


**オプティミズムのレイヤー2コントラクト（プリデプロイコントラクト）**

プリデプロイコントラクトは、ジェネシスブロック（最初に生成されたブロック）で事前に特定のアドレスに配置されます。プリデプロイコントラクトは、EVM（イーサリアム仮想マシン）内で直接実行されます。これは、マルチクライアント実装を容易にし、HardhatやFoundryなどの開発環境でのフォーキングを改善します。

プリデプロイコントラクトの例として、`WETH9`、`L2CrossDomainMessenger`、`L2StandardBridge`、`SequencerFeeVault`、`OptimismMintableERC20Factory`、`GasPriceOracle`、`GovernanceToken`、`L1Block`、`L2ToL1MessagePasser`、`L2ERC721Bridge`、`OptimismMintableERC721Factory`、`ProxyAdmin`、`BaseFeeVault`、`L1FeeVault`、`SchemaRegistry`、`EAS`（イーサリアムアテステーションサービス）、`BeaconBlockRoot` などがあります。これらは、ラップドイーサ（WETH）、L1とL2間のメッセージ送受信、トークンブリッジ、シーケンサーの手数料管理、ERC20トークンの生成、L1ブロック情報の取得、メッセージパサー、NFTブリッジ、Proxyコントラクトの管理、手数料管理など、L2で重要な機能を実行します。さらに、`EAS`のような新しい機能も追加され、分散型アプリケーション開発の可能性を大きく広げています。

また、`LegacyMessagePasser`、`DeployerWhitelist`、`LegacyERC20ETH`、`L1BlockNumber` など、過去に使われていたものの廃止されたコントラクトも存在します。

**本番環境への展開に向けて**

オプティミズムのスマートコントラクトを本番環境に展開する際には、以下の点に注意しましょう。

* **最新のリリースバージョンを使用する:** リリースノートをよく確認し、すべての契約が本番環境の準備が整っていることを確認します。Goコードのみのリリースにはコントラクトが含まれていないため、注意が必要です。
* **セキュリティ監査を実施する:** セキュリティ監査を通じて、脆弱性がないか確認します。
* **徹底的なテストを行う:** テストネットなどで徹底的なテストを行って、本番環境での動作を検証します。
* **ガバナンスプロセスに従う:** オプティミズムのガバナンスプロセスに従って、コントラクトの展開やアップグレードを行います。
* **モニタリングを行う:** 展開後も継続的にコントラクトをモニタリングし、問題がないかを確認します。
* **技術選定の戦略:** 新規の分散型アプリケーション(dApp)やスマートコントラクトの開発には、`op-viem` のような、最新のオプティミズムスタックに最適化されたツールを使用することを検討しましょう。これらのツールは、ガスの最適化など、更なる利便性を提供します。

**まとめ**

オプティミズムのスマートコントラクトは、イーサリアムの拡張性を高め、分散型アプリケーションの開発を促進する上で重要な役割を果たしています。今回のブログ投稿が、皆さんがオプティミズムのスマートコントラクトについて深く理解し、本番環境で安全に展開するのに役立つことを願っています。


この記事は2025年2月6日現在の情報に基づいて作成されており、今後のアップデートにより変更される可能性がありますので、ご了承ください。


引き続き、発信を続けますのでよろしくお願いします！
        